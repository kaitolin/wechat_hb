<!DOCTYPE html>
<html>

	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width,initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />
		<title>抢红包</title>
		<link href="__PUBLIC__/css/bootstrap.min.css" rel="stylesheet" />
        <script src="__PUBLIC__/js/jquery.min.js"></script>
		<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
		<style>
		.guide  {
		 	background: rgb(0, 0, 0); left: 0px; top: 0px; width: 100%; height: 100%; visibility: hidden; position: fixed; z-index: 1987; opacity: 0.97;
		}
		.guide_img {
				background: url("__PUBLIC__/img/share_tips.png") no-repeat 0% 0% / 200px; right: 50px; top: 35px; width: 200px; height: 225px; position: absolute;
			}
		</style>
		<script type="text/javascript">
			wx.config({
				debug: false,
				appId: '{$signPackage.appId}',
				timestamp: {$signPackage.timestamp},
				nonceStr: '{$signPackage.nonceStr}',
				signature: '{$signPackage.signature}',
				jsApiList: [
					'checkJsApi',
					'onMenuShareTimeline',
					'onMenuShareAppMessage',
					'onMenuShareQQ',
					'onMenuShareWeibo',
					'hideMenuItems',
					'showMenuItems',
					'hideAllNonBaseMenuItem',
					'showAllNonBaseMenuItem',
					'translateVoice',
					'startRecord',
					'stopRecord',
					'onRecordEnd',
					'playVoice',
					'pauseVoice',
					'stopVoice',
					'uploadVoice',
					'downloadVoice',
					'chooseImage',
					'previewImage',
					'uploadImage',
					'downloadImage',
					'getNetworkType',
					'openLocation',
					'getLocation',
					'hideOptionMenu',
					'showOptionMenu',
					'closeWindow',
					'scanQRCode',
					'chooseWXPay',
					'openProductSpecificView',
					'addCard',
					'chooseCard',
					'openCard'
				]
			});
			wx.ready(function () {
//			    wx.checkJsApi({
//			      jsApiList: [
//			         'onMenuShareTimeline',
//			      ],
//			      success: function (res) {
//			        alert(JSON.stringify(res));
//			      }
//			    });
			  //wx.hideOptionMenu();
			});
			wx.error(function (res) {
			  //alert(res.errMsg);
			}); 
	   $(function () {
			$("#btnShare").click(function () {
                   wx.onMenuShareTimeline({
					      title: '抢红包',
					      desc: '抢红包',
					      link: '{$signPackage.url}',
					      imgUrl: 'http://img3.douban.com/view/movie_poster_cover/spst/public/p2166127561.jpg',
					      success: function (res) {
					        //alert('已分享');
					      },
					      cancel: function (res) {
					        //alert('已取消');
					      },
					      fail: function (res) {
					        //alert(JSON.stringify(res));
					      }
					    });
					  $('#guide').css('visibility', 'visible');
            });
 
            $('#guide').click(function () {
                $('#guide').css('visibility', 'hidden');
            });
			var uid = '{$uid}';
			if (uid != null) {
				//alert(uid);

			}
			
<?php

	if(isset($_POST['action'])){
		echo '$("#divStart").css("display", "none");';
		echo '$("#divShare").css("display", "block");';
    }else{
		echo '$("#divStart").css("display", "block");';
    }
?>	
			function post(URL, PARAMS) {        
			    var temp = document.createElement("form");        
			    temp.action = URL;        
			    temp.method = "post";        
			    temp.style.display = "none";        
			    for (var x in PARAMS) {        
			        var opt = document.createElement("textarea");        
			        opt.name = x;        
			        opt.value = PARAMS[x];        
			        // alert(opt.name)        
			        temp.appendChild(opt);        
			    }        
			    document.body.appendChild(temp);        
			    temp.submit();        
			    return temp;        
			}   

			 $('#btnGame').click(function () {
			 	location.href = "__URL__/game";
			 	//post('__URL__/index', {action :'prnhtml',cm1:'sdsddsd',cm2:'haha'});
            });
		 });
		</script>
		
	</head>


	<body>

		<div id="divStart" style="display: none;">
			<div class="page-header">
				<h1>选择红包</h1>
			</div>
			<p class="lead">这是红包选择界面 openId:{$uid}</p>
			<button id="btnGame" class="btn btn-default"  type="button">开始游戏</button>
		</div>
		<div id="divShare" style="display: none;">
			<div class="page-header">
				<h1>恭喜获得红包</h1>
			</div>
			<p class="lead">分享到朋友圈,有3个好友点击即可获取20元家政红包</p>
			<button id="btnShare" class="btn btn-danger" type="button">分享</button>
		</div>
		<div id="guide" class="guide">
		<div class="guide_img"></div>
		</div>
			
	
		<!-- Include all compiled plugins (below), or include individual files as needed -->
		<script src="__PUBLIC__/js/bootstrap.min.js"></script>
	</body>

</html>